{% extends 'base.html' %} 
{% block content %}

<h1>Plan Details</h1>

<div class="card rounded-3 shadow-lg mb-3" style="width: 18rem">
  <div class="card-body">
    <h5 class="card-title pb-2">{{ plan.name }}</h5>

    <p>Start: {{ plan.start }}</p>
    <p>End: {{ plan.end }}</p>
    <a href="{% url 'plans_update' plan.id %}" class="btn btn-primary">Edit </a>
    <a href="{% url 'plans_delete' plan.id %}" class="btn btn-danger">Delete</a>
  </div>
</div>
</div> 
<div class="card rounded-3 shadow-lg mb-1">
  <form  action="{% url 'add_meal' plan.id %}" method="post">
    {% csrf_token %}
    {{ meal_form.as_p }}
    <input type="submit" class="btn btn-primary" value="Add Meal">
  </form>
  </div>

 <div class="card rounded-3 shadow-lg">
  <div class="card-body">
    {% for meal in plan.meal_set.all %}
    <p>{{meal.date}} - {{meal.get_meal_display}} - {{meal.name}} 
    {% if meal.recipe.count %}
     {% for recipe in meal.recipe.all %}
      <a href="{% url 'recipes_detail' recipe.id  %}">Recipe </a>
    {% endfor %}
    {% endif %}
   
    <div class="dropdown">
  <button class="btn btn-secondary btn-sm dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
    Add a Recipe
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
    {% for recipe in recipes %}
    <li><a class="dropdown-item" href="#">{{ recipe.name }}</a></li>
    {% endfor %}

    
  </ul>
</div>

    
    <a href="{% url 'meal_delete' plan.id meal.id %}" class="btn btn-sm btn-danger"> X </a></p>
    
     {% endfor %}
  </div>
</div>


{% endblock %}
